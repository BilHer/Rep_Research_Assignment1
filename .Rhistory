active.sums <- active.dataframe %>%
group_by(date, Weekday) %>%
summarise(totalStep = sum(steps))
my.cols <- brewer.pal(7, RBrewers.colors)
my.cols[1] <- my.cols[7]
max.sum <- max(active.sums$totalStep, na.rm = TRUE)
ggplot(active.sums, aes(x = date, y = totalStep, fill = Weekday)) + geom_bar(stat = "identity") +
scale_x_date(breaks = "1 day", limits = as.Date(c('2012-10-02','2012-11-29'))) +
theme_wsj() +
theme(axis.text.x  = element_text(size = 10, angle = 80, colour = "black", vjust = 1, hjust = 1)) +
scale_fill_manual(values = my.cols) +
geom_text(aes(x = date, y = totalStep, label = totalStep, angle  = 90, size = 8,
hjust = -0.1), color = "purple", show_guide  = F) +
coord_cartesian(ylim = c(0, max.sum*1.15)) +
geom_hline(aes ( yintercept = mean(totalStep, na.rm = TRUE)),
color = "blue", size = 3.5, alpha = .50) +
geom_hline(aes ( yintercept = median(totalStep, na.rm = TRUE)),
color = "green",size = 1.5, alpha = .50) +
geom_text(aes(label = paste("Overall Mean =", round(mean(totalStep, na.rm = TRUE), 3) ),
x = as.Date('2012-10-05'), y = 20200), color = "blue", size = 5) +
geom_text(aes(label = paste("Overall Median = ", round(median(totalStep, na.rm = TRUE), 3) ),
x = as.Date('2012-10-05'), y = 19700), color = "green", size = 5) +
ylab("Total Steps by Day") +
xlab(NULL)
}
make2.sums.ggplot(imputed, "Reds")
make2.sums.ggplot <- function(active.dataframe, RBrewers.colors = "Reds"){
active.sums <- active.dataframe %>%
group_by(date, Weekday) %>%
summarise(totalStep = sum(steps))
my.cols <- brewer.pal(7, RBrewers.colors)
my.cols[1] <- my.cols[7]
max.sum <- max(active.sums$totalStep, na.rm = TRUE)
ggplot(active.sums, aes(x = date, y = totalStep, fill = Weekday)) + geom_bar(stat = "identity") +
scale_x_date(breaks = "1 day", limits = as.Date(c('2012-10-02','2012-11-29'))) +
theme_wsj() +
theme(axis.text.x  = element_text(size = 10, angle = 80, colour = "black", vjust = 1, hjust = 1)) +
scale_fill_manual(values = my.cols) +
geom_text(aes(x = date, y = totalStep, label = totalStep, angle  = 90, size = 8,
hjust = -0.1), color = "purple", show_guide  = F) +
coord_cartesian(ylim = c(0, max.sum*1.15)) +
geom_hline(aes ( yintercept = mean(totalStep, na.rm = TRUE)),
color = "blue", size = 3.5, alpha = .50) +
geom_hline(aes ( yintercept = median(totalStep, na.rm = TRUE)),
color = "green",size = 1.5, alpha = .50) +
geom_text(aes(label = paste("Overall Mean = ", round(mean(totalStep, na.rm = TRUE), 5) ),
x = as.Date('2012-10-05'), y = 20200), color = "blue", size = 5) +
geom_text(aes(label = paste("Overall Median = ", round(median(totalStep, na.rm = TRUE), 5) ),
x = as.Date('2012-10-05'), y = 19700), color = "green", size = 5) +
ylab("Total Steps by Day") +
xlab(NULL)
}
make2.sums.ggplot(imputed, "Reds")
make2.sums.ggplot <- function(active.dataframe, RBrewers.colors = "Reds"){
active.sums <- active.dataframe %>%
group_by(date, Weekday) %>%
summarise(totalStep = sum(steps))
my.cols <- brewer.pal(7, RBrewers.colors)
my.cols[1] <- my.cols[7]
max.sum <- max(active.sums$totalStep, na.rm = TRUE)
ggplot(active.sums, aes(x = date, y = totalStep, fill = Weekday)) + geom_bar(stat = "identity") +
scale_x_date(breaks = "1 day", limits = as.Date(c('2012-10-02','2012-11-29'))) +
theme_wsj() +
theme(axis.text.x  = element_text(size = 10, angle = 80, colour = "black", vjust = 1, hjust = 1)) +
scale_fill_manual(values = my.cols) +
geom_text(aes(x = date, y = totalStep, label = totalStep, angle  = 90, size = 8,
hjust = -0.1), color = "purple", show_guide  = F) +
coord_cartesian(ylim = c(0, max.sum*1.15)) +
geom_hline(aes ( yintercept = mean(totalStep, na.rm = TRUE)),
color = "blue", size = 3.5, alpha = .50) +
geom_hline(aes ( yintercept = median(totalStep, na.rm = TRUE)),
color = "darkgreen",size = 1.5, alpha = .50) +
geom_text(aes(label = paste("Overall Mean = ", round(mean(totalStep, na.rm = TRUE), 5) ),
x = as.Date('2012-10-05'), y = 20200), color = "blue", size = 5) +
geom_text(aes(label = paste("Overall Median = ", round(median(totalStep, na.rm = TRUE), 5) ),
x = as.Date('2012-10-05'), y = 19700), color = "darkgreen", size = 5) +
ylab("Total Steps by Day") +
xlab(NULL)
}
make2.sums.ggplot(imputed, "Reds")
make2.sums.ggplot <- function(active.dataframe, RBrewers.colors = "Reds"){
active.sums <- active.dataframe %>%
group_by(date, Weekday) %>%
summarise(totalStep = sum(steps))
my.cols <- brewer.pal(7, RBrewers.colors)
my.cols[1] <- my.cols[7]
max.sum <- max(active.sums$totalStep, na.rm = TRUE)
ggplot(active.sums, aes(x = date, y = totalStep, fill = Weekday)) + geom_bar(stat = "identity") +
scale_x_date(breaks = "1 day", limits = as.Date(c('2012-10-02','2012-11-29'))) +
theme_wsj() +
theme(axis.text.x  = element_text(size = 10, angle = 80, colour = "black", vjust = 1, hjust = 1)) +
scale_fill_manual(values = my.cols) +
geom_text(aes(x = date, y = totalStep, label = totalStep, angle  = 90, size = 8,
hjust = -0.1), color = "purple", show_guide  = F) +
coord_cartesian(ylim = c(0, max.sum*1.15)) +
geom_hline(aes ( yintercept = mean(totalStep, na.rm = TRUE)),
color = "blue", size = 2.5, alpha = .50) +
geom_hline(aes ( yintercept = median(totalStep, na.rm = TRUE)),
color = "darkgreen",size = 2.5, alpha = .50) +
geom_text(aes(label = paste("  Overall Mean = ", round(mean(totalStep, na.rm = TRUE), 5) ),
x = as.Date('2012-10-01'), y = 20200), color = "blue", size = 5) +
geom_text(aes(label = paste("  Overall Median = ", round(median(totalStep, na.rm = TRUE), 5) ),
x = as.Date('2012-10-01'), y = 19700), color = "darkgreen", size = 5) +
ylab("Total Steps by Day") +
xlab(NULL)
}
make2.sums.ggplot(imputed, "Reds")
make2.sums.ggplot <- function(active.dataframe, RBrewers.colors = "Reds"){
active.sums <- active.dataframe %>%
group_by(date, Weekday) %>%
summarise(totalStep = sum(steps))
my.cols <- brewer.pal(7, RBrewers.colors)
my.cols[1] <- my.cols[7]
max.sum <- max(active.sums$totalStep, na.rm = TRUE)
ggplot(active.sums, aes(x = date, y = totalStep, fill = Weekday)) + geom_bar(stat = "identity") +
scale_x_date(breaks = "1 day", limits = as.Date(c('2012-10-02','2012-11-29'))) +
theme_wsj() +
theme(axis.text.x  = element_text(size = 10, angle = 80, colour = "black", vjust = 1, hjust = 1)) +
scale_fill_manual(values = my.cols) +
geom_text(aes(x = date, y = totalStep, label = totalStep, angle  = 90, size = 8,
hjust = -0.1), color = "purple", show_guide  = F) +
coord_cartesian(ylim = c(0, max.sum*1.15)) +
geom_hline(aes ( yintercept = mean(totalStep, na.rm = TRUE)),
color = "blue", size = 1.5, alpha = .70) +
geom_hline(aes ( yintercept = median(totalStep, na.rm = TRUE)),
color = "darkgreen",size = 1.5, alpha = .60) +
geom_text(aes(label = paste("Overall Mean = ", round(mean(totalStep, na.rm = TRUE), 5) ),
x = as.Date('2012-10-01'), y = 20200), color = "blue", size = 5) +
geom_text(aes(label = paste("Overall Median = ", round(median(totalStep, na.rm = TRUE), 5) ),
x = as.Date('2012-10-01'), y = 19700), color = "darkgreen", size = 5) +
ylab("Total Steps by Day") +
xlab(NULL)
}
make2.sums.ggplot(imputed, "Reds")
make2.sums.ggplot <- function(active.dataframe, RBrewers.colors = "Reds"){
active.sums <- active.dataframe %>%
group_by(date, Weekday) %>%
summarise(totalStep = sum(steps))
my.cols <- brewer.pal(7, RBrewers.colors)
my.cols[1] <- my.cols[7]
max.sum <- max(active.sums$totalStep, na.rm = TRUE)
ggplot(active.sums, aes(x = date, y = totalStep, fill = Weekday)) + geom_bar(stat = "identity") +
scale_x_date(breaks = "1 day", limits = as.Date(c('2012-10-02','2012-11-29'))) +
theme_wsj() +
theme(axis.text.x  = element_text(size = 10, angle = 80, colour = "black", vjust = 1, hjust = 1)) +
scale_fill_manual(values = my.cols) +
geom_text(aes(x = date, y = totalStep, label = totalStep, angle  = 90, size = 8,
hjust = -0.1), color = "purple", show_guide  = F) +
coord_cartesian(ylim = c(0, max.sum*1.15)) +
geom_hline(aes ( yintercept = mean(totalStep, na.rm = TRUE)),
color = "blue", size = 1.5, alpha = .70) +
geom_hline(aes ( yintercept = median(totalStep, na.rm = TRUE)),
color = "darkgreen",size = 1.5, alpha = .60) +
geom_text(aes(label = paste(" Overall Mean = ", round(mean(totalStep, na.rm = TRUE), 5) ),
x = as.Date('2012-10-01'), y = 20200), color = "blue", size = 5) +
geom_text(aes(label = paste(" Overall Median = ", round(median(totalStep, na.rm = TRUE), 5) ),
x = as.Date('2012-10-01'), y = 19700), color = "darkgreen", size = 5) +
ylab("Total Steps by Day") +
xlab(NULL)
}
make2.sums.ggplot(imputed, "Reds")
make2.sums.ggplot <- function(active.dataframe, RBrewers.colors = "Reds"){
active.sums <- active.dataframe %>%
group_by(date, Weekday) %>%
summarise(totalStep = sum(steps))
my.cols <- brewer.pal(7, RBrewers.colors)
my.cols[1] <- my.cols[7]
max.sum <- max(active.sums$totalStep, na.rm = TRUE)
ggplot(active.sums, aes(x = date, y = totalStep, fill = Weekday)) + geom_bar(stat = "identity") +
scale_x_date(breaks = "1 day", limits = as.Date(c('2012-10-02','2012-11-29'))) +
theme_wsj() +
theme(axis.text.x  = element_text(size = 10, angle = 80, colour = "black", vjust = 1, hjust = 1)) +
scale_fill_manual(values = my.cols) +
geom_text(aes(x = date, y = totalStep, label = totalStep, angle  = 90, size = 8,
hjust = -0.1), color = "purple", show_guide  = F) +
coord_cartesian(ylim = c(0, max.sum*1.15)) +
geom_hline(aes ( yintercept = mean(totalStep, na.rm = TRUE)),
color = "blue", size = 1.5, alpha = .70) +
geom_hline(aes ( yintercept = median(totalStep, na.rm = TRUE)),
color = "darkgreen",size = 1.5, alpha = .60) +
geom_text(aes(label = paste("       Overall Mean = ", round(mean(totalStep, na.rm = TRUE), 5) ),
x = as.Date('2012-10-01'), y = 20200), color = "blue", size = 5) +
geom_text(aes(label = paste("       Overall Median = ", round(median(totalStep, na.rm = TRUE), 5) ),
x = as.Date('2012-10-01'), y = 19700), color = "darkgreen", size = 5) +
ylab("Total Steps by Day") +
xlab(NULL)
}
make2.sums.ggplot(imputed, "Reds")
make2.sums.ggplot <- function(active.dataframe, RBrewers.colors = "Reds"){
active.sums <- active.dataframe %>%
group_by(date, Weekday) %>%
summarise(totalStep = sum(steps))
my.cols <- brewer.pal(7, RBrewers.colors)
my.cols[1] <- my.cols[7]
max.sum <- max(active.sums$totalStep, na.rm = TRUE)
ggplot(active.sums, aes(x = date, y = totalStep, fill = Weekday)) + geom_bar(stat = "identity") +
scale_x_date(breaks = "1 day", limits = as.Date(c('2012-10-02','2012-11-29'))) +
theme_wsj() +
theme(axis.text.x  = element_text(size = 10, angle = 80, colour = "black", vjust = 1, hjust = 1)) +
scale_fill_manual(values = my.cols) +
geom_text(aes(x = date, y = totalStep, label = totalStep, angle  = 90, size = 8,
hjust = -0.1), color = "purple", show_guide  = F) +
coord_cartesian(ylim = c(0, max.sum*1.15)) +
geom_hline(aes ( yintercept = mean(totalStep, na.rm = TRUE)),
color = "blue", size = 1.5, alpha = .70) +
geom_hline(aes ( yintercept = median(totalStep, na.rm = TRUE)),
color = "darkgreen",size = 1.5, alpha = .60) +
geom_text(aes(label = paste("Mean = ", round(mean(totalStep, na.rm = TRUE), 5) ),
x = as.Date('2012-10-07'), y = 20200), color = "blue", size = 5) +
geom_text(aes(label = paste("Median = ", round(median(totalStep, na.rm = TRUE), 5) ),
x = as.Date('2012-10-07'), y = 19700), color = "darkgreen", size = 5) +
ylab("Total Steps by Day") +
xlab(NULL)
}
make2.sums.ggplot(imputed, "Reds")
make2.sums.ggplot <- function(active.dataframe, RBrewers.colors = "Reds"){
active.sums <- active.dataframe %>%
group_by(date, Weekday) %>%
summarise(totalStep = sum(steps))
my.cols <- brewer.pal(7, RBrewers.colors)
my.cols[1] <- my.cols[7]
max.sum <- max(active.sums$totalStep, na.rm = TRUE)
ggplot(active.sums, aes(x = date, y = totalStep, fill = Weekday)) + geom_bar(stat = "identity") +
scale_x_date(breaks = "1 day", limits = as.Date(c('2012-10-02','2012-11-29'))) +
theme_wsj() +
theme(axis.text.x  = element_text(size = 10, angle = 80, colour = "black", vjust = 1, hjust = 1)) +
scale_fill_manual(values = my.cols) +
geom_text(aes(x = date, y = totalStep, label = totalStep, angle  = 90, size = 8,
hjust = -0.1), color = "purple", show_guide  = F) +
coord_cartesian(ylim = c(0, max.sum*1.15)) +
geom_hline(aes ( yintercept = mean(totalStep, na.rm = TRUE)),
color = "blue", size = 1.5, alpha = .70) +
geom_hline(aes ( yintercept = median(totalStep, na.rm = TRUE)),
color = "darkgreen",size = 1.5, alpha = .60) +
geom_text(aes(label = paste("Mean = ", round(mean(totalStep, na.rm = TRUE), 5) ),
x = as.Date('2012-10-07'), y = 20200), color = "blue", size = 5) +
geom_text(aes(label = paste("Median = ", round(median(totalStep, na.rm = TRUE), 5) ),
x = as.Date('2012-10-04'), y = 19700), color = "darkgreen", size = 5) +
ylab("Total Steps by Day") +
xlab(NULL)
}
make2.sums.ggplot(imputed, "Reds")
make2.sums.ggplot <- function(active.dataframe, RBrewers.colors = "Reds"){
active.sums <- active.dataframe %>%
group_by(date, Weekday) %>%
summarise(totalStep = sum(steps))
my.cols <- brewer.pal(7, RBrewers.colors)
my.cols[1] <- my.cols[7]
max.sum <- max(active.sums$totalStep, na.rm = TRUE)
ggplot(active.sums, aes(x = date, y = totalStep, fill = Weekday)) + geom_bar(stat = "identity") +
scale_x_date(breaks = "1 day", limits = as.Date(c('2012-10-02','2012-11-29'))) +
theme_wsj() +
theme(axis.text.x  = element_text(size = 10, angle = 80, colour = "black", vjust = 1, hjust = 1)) +
scale_fill_manual(values = my.cols) +
geom_text(aes(x = date, y = totalStep, label = totalStep, angle  = 90, size = 8,
hjust = -0.1), color = "purple", show_guide  = F) +
coord_cartesian(ylim = c(0, max.sum*1.15)) +
geom_hline(aes ( yintercept = mean(totalStep, na.rm = TRUE)),
color = "blue", size = 1.5, alpha = .70) +
geom_hline(aes ( yintercept = median(totalStep, na.rm = TRUE)),
color = "darkgreen",size = 1.5, alpha = .60) +
geom_text(aes(label = paste("Mean = ", round(mean(totalStep, na.rm = TRUE), 5) ),
x = as.Date('2012-10-07'), y = 20200), color = "blue", size = 5) +
geom_text(aes(label = paste("Median = ", round(median(totalStep, na.rm = TRUE), 5) ),
x = as.Date('2012-10-05'), y = 19700), color = "darkgreen", size = 5) +
ylab("Total Steps by Day") +
xlab(NULL)
}
make2.sums.ggplot(imputed, "Reds")
make2.sums.ggplot <- function(active.dataframe, RBrewers.colors = "Reds"){
active.sums <- active.dataframe %>%
group_by(date, Weekday) %>%
summarise(totalStep = sum(steps))
my.cols <- brewer.pal(7, RBrewers.colors)
my.cols[1] <- my.cols[7]
max.sum <- max(active.sums$totalStep, na.rm = TRUE)
ggplot(active.sums, aes(x = date, y = totalStep, fill = Weekday)) + geom_bar(stat = "identity") +
scale_x_date(breaks = "1 day", limits = as.Date(c('2012-10-02','2012-11-29'))) +
theme_wsj() +
theme(axis.text.x  = element_text(size = 10, angle = 80, colour = "black", vjust = 1, hjust = 1)) +
scale_fill_manual(values = my.cols) +
geom_text(aes(x = date, y = totalStep, label = totalStep, angle  = 90, size = 8,
hjust = -0.1), color = "purple", show_guide  = F) +
coord_cartesian(ylim = c(0, max.sum*1.15)) +
geom_hline(aes ( yintercept = mean(totalStep, na.rm = TRUE)),
color = "blue", size = 1.5, alpha = .70) +
geom_hline(aes ( yintercept = median(totalStep, na.rm = TRUE)),
color = "darkgreen",size = 1.5, alpha = .60) +
geom_text(aes(label = paste("Mean = ", round(mean(totalStep, na.rm = TRUE), 5) ),
x = as.Date('2012-10-07'), y = 20200), color = "blue", size = 5) +
geom_text(aes(label = paste("Median = ", round(median(totalStep, na.rm = TRUE), 5) ),
x = as.Date('2012-10-06'), y = 19700), color = "darkgreen", size = 5) +
ylab("Total Steps by Day") +
xlab(NULL)
}
make2.sums.ggplot(imputed, "Reds")
make2.sums.ggplot <- function(active.dataframe, RBrewers.colors = "Reds"){
active.sums <- active.dataframe %>%
group_by(date, Weekday) %>%
summarise(totalStep = sum(steps))
my.cols <- brewer.pal(7, RBrewers.colors)
my.cols[1] <- my.cols[7]
max.sum <- max(active.sums$totalStep, na.rm = TRUE)
ggplot(active.sums, aes(x = date, y = totalStep, fill = Weekday)) + geom_bar(stat = "identity") +
scale_x_date(breaks = "1 day", limits = as.Date(c('2012-10-02','2012-11-29'))) +
theme_wsj() +
theme(axis.text.x  = element_text(size = 10, angle = 80, colour = "black", vjust = 1, hjust = 1)) +
scale_fill_manual(values = my.cols) +
geom_text(aes(x = date, y = totalStep, label = totalStep, angle  = 90, size = 8,
hjust = -0.1), color = "purple", show_guide  = F) +
coord_cartesian(ylim = c(0, max.sum*1.15)) +
geom_hline(aes ( yintercept = mean(totalStep, na.rm = TRUE)),
color = "blue", size = 1.5, alpha = .70) +
geom_hline(aes ( yintercept = median(totalStep, na.rm = TRUE)),
color = "darkgreen",size = 1.5, alpha = .60) +
geom_text(aes(label = paste("Mean = ", round(mean(totalStep, na.rm = TRUE), 5) ),
x = as.Date('2012-10-07'), y = 20200), color = "blue", size = 7) +
geom_text(aes(label = paste("Median = ", round(median(totalStep, na.rm = TRUE), 5) ),
x = as.Date('2012-10-06'), y = 19700), color = "darkgreen", size = 7) +
ylab("Total Steps by Day") +
xlab(NULL)
}
make2.sums.ggplot(imputed, "Reds")
make2.sums.ggplot <- function(active.dataframe, RBrewers.colors = "Reds"){
active.sums <- active.dataframe %>%
group_by(date, Weekday) %>%
summarise(totalStep = sum(steps))
my.cols <- brewer.pal(7, RBrewers.colors)
my.cols[1] <- my.cols[7]
max.sum <- max(active.sums$totalStep, na.rm = TRUE)
ggplot(active.sums, aes(x = date, y = totalStep, fill = Weekday)) + geom_bar(stat = "identity") +
scale_x_date(breaks = "1 day", limits = as.Date(c('2012-10-02','2012-11-29'))) +
theme_wsj() +
theme(axis.text.x  = element_text(size = 10, angle = 80, colour = "black", vjust = 1, hjust = 1)) +
scale_fill_manual(values = my.cols) +
geom_text(aes(x = date, y = totalStep, label = totalStep, angle  = 90, size = 8,
hjust = -0.1), color = "purple", show_guide  = F) +
coord_cartesian(ylim = c(0, max.sum*1.15)) +
geom_hline(aes ( yintercept = mean(totalStep, na.rm = TRUE)),
color = "blue", size = 1.5, alpha = .70) +
geom_hline(aes ( yintercept = median(totalStep, na.rm = TRUE)),
color = "darkgreen",size = 1.5, alpha = .60) +
geom_text(aes(label = paste("Mean = ", round(mean(totalStep, na.rm = TRUE), 5) ),
x = as.Date('2012-10-07'), y = 20200), color = "blue", size = 7) +
geom_text(aes(label = paste("Median = ", round(median(totalStep, na.rm = TRUE), 7) ),
x = as.Date('2012-10-06'), y = 19700), color = "darkgreen", size = 7) +
ylab("Total Steps by Day") +
xlab(NULL)
}
make2.sums.ggplot(imputed, "Reds")
make2.sums.ggplot <- function(active.dataframe, RBrewers.colors = "Reds"){
active.sums <- active.dataframe %>%
group_by(date, Weekday) %>%
summarise(totalStep = sum(steps))
my.cols <- brewer.pal(7, RBrewers.colors)
my.cols[1] <- my.cols[7]
max.sum <- max(active.sums$totalStep, na.rm = TRUE)
ggplot(active.sums, aes(x = date, y = totalStep, fill = Weekday)) + geom_bar(stat = "identity") +
scale_x_date(breaks = "1 day", limits = as.Date(c('2012-10-02','2012-11-29'))) +
theme_wsj() +
theme(axis.text.x  = element_text(size = 10, angle = 80, colour = "black", vjust = 1, hjust = 1)) +
scale_fill_manual(values = my.cols) +
geom_text(aes(x = date, y = totalStep, label = totalStep, angle  = 90, size = 8,
hjust = -0.1), color = "purple", show_guide  = F) +
coord_cartesian(ylim = c(0, max.sum*1.15)) +
geom_hline(aes ( yintercept = mean(totalStep, na.rm = TRUE)),
color = "blue", size = 1.5, alpha = .70) +
geom_hline(aes ( yintercept = median(totalStep, na.rm = TRUE)),
color = "darkgreen",size = 1.5, alpha = .60) +
geom_text(aes(label = paste("Mean = ", round(mean(totalStep, na.rm = TRUE), 3) ),
x = as.Date('2012-10-07'), y = 20200), color = "blue", size = 7) +
geom_text(aes(label = paste("Median = ", round(median(totalStep, na.rm = TRUE), 5) ),
x = as.Date('2012-10-06'), y = 19700), color = "darkgreen", size = 7) +
ylab("Total Steps by Day") +
xlab(NULL)
}
make2.sums.ggplot(imputed, "Reds")
make2.sums.ggplot <- function(active.dataframe, RBrewers.colors = "Reds"){
active.sums <- active.dataframe %>%
group_by(date, Weekday) %>%
summarise(totalStep = sum(steps))
my.cols <- brewer.pal(7, RBrewers.colors)
my.cols[1] <- my.cols[7]
max.sum <- max(active.sums$totalStep, na.rm = TRUE)
ggplot(active.sums, aes(x = date, y = totalStep, fill = Weekday)) + geom_bar(stat = "identity") +
scale_x_date(breaks = "1 day", limits = as.Date(c('2012-10-02','2012-11-29'))) +
theme_wsj() +
theme(axis.text.x  = element_text(size = 10, angle = 80, colour = "black", vjust = 1, hjust = 1)) +
scale_fill_manual(values = my.cols) +
geom_text(aes(x = date, y = totalStep, label = totalStep, angle  = 90, size = 8,
hjust = -0.1), color = "purple", show_guide  = F) +
coord_cartesian(ylim = c(0, max.sum*1.15)) +
geom_hline(aes ( yintercept = mean(totalStep, na.rm = TRUE)),
color = "blue", size = 1.5, alpha = .70) +
geom_hline(aes ( yintercept = median(totalStep, na.rm = TRUE)),
color = "darkgreen",size = 1.5, alpha = .60) +
geom_text(aes(label = paste("Mean = ", round(mean(totalStep, na.rm = TRUE), 5)),
x = as.Date('2012-10-07'), y = 20200), color = "blue", size = 6) +
geom_text(aes(label = paste("Median = ", round(median(totalStep, na.rm = TRUE), 5)),
x = as.Date('2012-10-06'), y = 19700), color = "darkgreen", size = 6) +
ylab("Total Steps by Day") +
xlab(NULL)
}
make2.sums.ggplot(imputed, "Reds")
make2.sums.ggplot <- function(active.dataframe, RBrewers.colors = "Reds"){
active.sums <- active.dataframe %>%
group_by(date, Weekday) %>%
summarise(totalStep = sum(steps))
my.cols <- brewer.pal(7, RBrewers.colors)
my.cols[1] <- my.cols[7]
max.sum <- max(active.sums$totalStep, na.rm = TRUE)
ggplot(active.sums, aes(x = date, y = totalStep, fill = Weekday)) + geom_bar(stat = "identity") +
scale_x_date(breaks = "1 day", limits = as.Date(c('2012-10-02','2012-11-29'))) +
theme_wsj() +
theme(axis.text.x  = element_text(size = 10, angle = 80, colour = "black", vjust = 1, hjust = 1)) +
scale_fill_manual(values = my.cols) +
geom_text(aes(x = date, y = totalStep, label = totalStep, angle  = 90, size = 8,
hjust = -0.1), color = "purple", show_guide  = F) +
coord_cartesian(ylim = c(0, max.sum*1.15)) +
geom_hline(aes ( yintercept = mean(totalStep, na.rm = TRUE)),
color = "blue", size = 1.5, alpha = .70) +
geom_hline(aes ( yintercept = median(totalStep, na.rm = TRUE)),
color = "darkgreen",size = 1.5, alpha = .60) +
geom_text(aes(label = paste("Mean = ", round(mean(totalStep, na.rm = TRUE), 5)),
x = as.Date('2012-10-07'), y = 20200), color = "blue", size = 6) +
geom_text(aes(label = paste("Median = ", round(median(totalStep, na.rm = TRUE), 5)),
x = as.Date('2012-10-06'), y = 18700), color = "darkgreen", size = 6) +
ylab("Total Steps by Day") +
xlab(NULL)
}
make2.sums.ggplot(imputed, "Reds")
make2.sums.ggplot <- function(active.dataframe, RBrewers.colors = "Reds"){
active.sums <- active.dataframe %>%
group_by(date, Weekday) %>%
summarise(totalStep = sum(steps))
my.cols <- brewer.pal(7, RBrewers.colors)
my.cols[1] <- my.cols[7]
max.sum <- max(active.sums$totalStep, na.rm = TRUE)
ggplot(active.sums, aes(x = date, y = totalStep, fill = Weekday)) + geom_bar(stat = "identity") +
scale_x_date(breaks = "1 day", limits = as.Date(c('2012-10-02','2012-11-29'))) +
theme_wsj() +
theme(axis.text.x  = element_text(size = 10, angle = 80, colour = "black", vjust = 1, hjust = 1)) +
scale_fill_manual(values = my.cols) +
geom_text(aes(x = date, y = totalStep, label = totalStep, angle  = 90, size = 8,
hjust = -0.1), color = "purple", show_guide  = F) +
coord_cartesian(ylim = c(0, max.sum*1.15)) +
geom_hline(aes ( yintercept = mean(totalStep, na.rm = TRUE)),
color = "blue", size = 1.5, alpha = .70) +
geom_hline(aes ( yintercept = median(totalStep, na.rm = TRUE)),
color = "darkgreen",size = 1.5, alpha = .60) +
geom_text(aes(label = paste("Mean = ", round(mean(totalStep, na.rm = TRUE), 5)),
x = as.Date('2012-10-07'), y = 19200), color = "blue", size = 6) +
geom_text(aes(label = paste("Median = ", round(median(totalStep, na.rm = TRUE), 5)),
x = as.Date('2012-10-06'), y = 18500), color = "darkgreen", size = 6) +
ylab("Total Steps by Day") +
xlab(NULL)
}
make2.sums.ggplot(imputed, "Reds")
make2.sums.ggplot <- function(active.dataframe, RBrewers.colors = "Reds"){
active.sums <- active.dataframe %>%
group_by(date, Weekday) %>%
summarise(totalStep = sum(steps))
my.cols <- brewer.pal(7, RBrewers.colors)
my.cols[1] <- my.cols[7]
max.sum <- max(active.sums$totalStep, na.rm = TRUE)
ggplot(active.sums, aes(x = date, y = totalStep, fill = Weekday)) + geom_bar(stat = "identity") +
scale_x_date(breaks = "1 day", limits = as.Date(c('2012-10-02','2012-11-29'))) +
theme_wsj() +
theme(axis.text.x  = element_text(size = 10, angle = 80, colour = "black", vjust = 1, hjust = 1)) +
scale_fill_manual(values = my.cols) +
geom_text(aes(x = date, y = totalStep, label = totalStep, angle  = 90, size = 8,
hjust = -0.1), color = "purple", show_guide  = F) +
coord_cartesian(ylim = c(0, max.sum*1.15)) +
geom_hline(aes ( yintercept = mean(totalStep, na.rm = TRUE)),
color = "blue", size = 1.5, alpha = .70) +
geom_hline(aes ( yintercept = median(totalStep, na.rm = TRUE)),
color = "darkgreen",size = 1.5, alpha = .60) +
geom_text(aes(label = paste("Mean = ", round(mean(totalStep, na.rm = TRUE), 5)),
x = as.Date('2012-10-07'), y = 20000), color = "blue", size = 6) +
geom_text(aes(label = paste("Median = ", round(median(totalStep, na.rm = TRUE), 5)),
x = as.Date('2012-10-06'), y = 18500), color = "darkgreen", size = 6) +
ylab("Total Steps by Day") +
xlab(NULL)
}
make2.sums.ggplot(imputed, "Reds")
make2.sums.ggplot <- function(active.dataframe, RBrewers.colors = "Reds"){
active.sums <- active.dataframe %>%
group_by(date, Weekday) %>%
summarise(totalStep = sum(steps))
my.cols <- brewer.pal(7, RBrewers.colors)
my.cols[1] <- my.cols[7]
max.sum <- max(active.sums$totalStep, na.rm = TRUE)
ggplot(active.sums, aes(x = date, y = totalStep, fill = Weekday)) + geom_bar(stat = "identity") +
scale_x_date(breaks = "1 day", limits = as.Date(c('2012-10-02','2012-11-29'))) +
theme_wsj() +
theme(axis.text.x  = element_text(size = 10, angle = 80, colour = "black", vjust = 1, hjust = 1)) +
scale_fill_manual(values = my.cols) +
geom_text(aes(x = date, y = totalStep, label = totalStep, angle  = 90, size = 8,
hjust = -0.1), color = "purple", show_guide  = F) +
coord_cartesian(ylim = c(0, max.sum*1.15)) +
geom_hline(aes ( yintercept = mean(totalStep, na.rm = TRUE)),
color = "blue", size = 1.5, alpha = .70) +
geom_hline(aes ( yintercept = median(totalStep, na.rm = TRUE)),
color = "darkgreen",size = 1.5, alpha = .60) +
geom_text(aes(label = paste("Mean = ", round(mean(totalStep, na.rm = TRUE), 5)),
x = as.Date('2012-10-07'), y = 19800), color = "blue", size = 6) +
geom_text(aes(label = paste("Median = ", round(median(totalStep, na.rm = TRUE), 5)),
x = as.Date('2012-10-06'), y = 18500), color = "darkgreen", size = 6) +
ylab("Total Steps by Day") +
xlab(NULL)
}
make2.sums.ggplot(imputed, "Reds")
